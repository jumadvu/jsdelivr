/**
 * highcharts-ng
 * @version v0.0.13 - 2016-10-04
 * @link https://github.com/pablojim/highcharts-ng
 * @author Barry Fitzgerald <>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
typeof module!="undefined"&&typeof exports!="undefined"&&module.exports===exports&&(module.exports="highcharts-ng"),function(){"use strict";function i(n,t,i){i===undefined&&(i=0);i<0&&(i+=n.length);i<0&&(i=0);for(var r=n.length;i<r;i++)if(i in n&&n[i]===t)return i;return-1}function t(n,t,i){var r=n[t];n[t]=function(){var n=Array.prototype.slice.call(arguments);if(i.apply(this,n),r)return r.apply(this,n)}}function n(t,i){var r,u;if(angular.isArray(i))for(t=angular.isArray(t)?t:[],r=0;r<i.length;r++)t[r]=n(t[r]||{},i[r]);else if(angular.isObject(i)){t=angular.isObject(t)?t:{};for(u in i)t[u]=n(t[u]||{},i[u])}else t=i;return t}function r(n,t){function i(){return r}var r=n.when(t.Highcharts);return{getHighcharts:i,ready:function(n,t){i().then(function(){n.call(t)})}}}function u(r,u){function y(n,t,r){var l={},h=!1,y=function(n,r){var u,s=[],a,e,f;if(n){if(a=c(n),a&&!t.disableDataWatch)return!1;if(angular.forEach(n,function(n,t){var i;if(s.push(n.id),i=h.get(n.id),i)if(angular.equals(l[n.id],o(n)))if(n.visible!==undefined&&i.visible!==n.visible&&i.setVisible(n.visible,!1),t<r.length){var e=r[t],u=angular.copy(e),f=n.data[n.data.length-1];u.data.push(f);angular.equals(u,n)?i.addPoint(f,!1):(u.data.shift(),angular.equals(u,n)?i.addPoint(f,!1,!0):i.setData(angular.copy(n.data),!1))}else i.setData(angular.copy(n.data),!1);else i.update(angular.copy(n),!1);else h.addSeries(angular.copy(n),!1);l[n.id]=o(n)}),t.config.noData){for(e=!1,u=0;u<n.length;u++)if(n[u].data&&n[u].data.length>0){e=!0;break}e?h.hideLoading():h.showLoading(t.config.noData)}}for(u=h.series.length-1;u>=0;u--)f=h.series[u],f.options.id!=="highcharts-navigator-series"&&i(s,f.options.id)<0&&f.remove(!1);return!0},p=function(){var u;h&&h.destroy();l={};var i=t.config||{},e=a(t,r,i),o=i.func||undefined,c=s(t);for(h=new n[c](e,o),u=0;u<f.length;u++)i[f[u]]&&v(h,i[f[u]],f[u]);i.loading&&h.showLoading();i.getHighcharts=function(){return h}};p();t.disableDataWatch?t.$watchCollection("config.series",function(n){y(n);h.redraw()}):t.$watch("config.series",function(n,t){var i=y(n,t);i&&h.redraw()},!0);t.$watch("config.title",function(n){h.setTitle(n,!0)},!0);t.$watch("config.subtitle",function(n){h.setTitle(!0,n)},!0);t.$watch("config.loading",function(n){n?h.showLoading(n===!0?null:n):h.hideLoading()});t.$watch("config.noData",function(n){t.config&&t.config.loading&&h.showLoading(n)},!0);t.$watch("config.credits.enabled",function(n){n?h.credits.show():h.credits&&h.credits.hide()});t.$watch(s,function(n,t){n!==t&&p()});angular.forEach(f,function(n){t.$watch("config."+n,function(t){var i,r;if(t){if(angular.isArray(t))for(i=0;i<t.length;i++)r=t[i],i<h[n].length&&(h[n][i].update(r,!1),e(h[n][i],angular.copy(r)));else h[n][0].update(t,!1),e(h[n][0],angular.copy(t));h.redraw()}},!0)});t.$watch("config.options",function(n,t,i){n!==t&&(p(),y(i.config.series),h.redraw())},!0);t.$watch("config.size",function(n,t){n!==t&&n&&h.setSize(n.width||h.chartWidth,n.height||h.chartHeight)},!0);t.$on("highchartsng.reflow",function(){h.reflow()});t.$on("$destroy",function(){if(h){try{h.destroy()}catch(n){}u(function(){r.remove()},0)}})}function p(n,t,i){function u(r){y(r,n,t,i)}r.getHighcharts().then(u)}var h=0,c=function(n){var t=!1;return angular.forEach(n,function(n){angular.isDefined(n.id)||(n.id="series-"+h++,t=!0)}),t},f=["xAxis","yAxis"],l={stock:"StockChart",map:"Map",chart:"Chart"},a=function(i,r,e){var o={},s={chart:{events:{}},title:{},subtitle:{},series:[],credits:{},plotOptions:{},navigator:{enabled:!1},xAxis:{events:{}},yAxis:{events:{}}};return o=e.options?n(s,e.options):s,o.chart.renderTo=r[0],angular.forEach(f,function(r){angular.isDefined(e[r])&&(o[r]=n(o[r]||{},e[r]),(angular.isDefined(e[r].currentMin)||angular.isDefined(e[r].currentMax))&&(t(o.chart.events,"selection",function(n){var t=this;n[r]?i.$apply(function(){i.config[r].currentMin=n[r][0].min;i.config[r].currentMax=n[r][0].max}):i.$apply(function(){i.config[r].currentMin=t[r][0].dataMin;i.config[r].currentMax=t[r][0].dataMax})}),t(o.chart.events,"addSeries",function(){i.config[r].currentMin=this[r][0].min||i.config[r].currentMin;i.config[r].currentMax=this[r][0].max||i.config[r].currentMax}),t(o[r].events,"setExtremes",function(n){n.trigger&&n.trigger!=="zoom"&&u(function(){i.config[r].currentMin=n.min;i.config[r].currentMax=n.max;i.config[r].min=n.min;i.config[r].max=n.max},0)})))}),e.title&&(o.title=e.title),e.subtitle&&(o.subtitle=e.subtitle),e.credits&&(o.credits=e.credits),e.size&&(e.size.width&&(o.chart.width=e.size.width),e.size.height&&(o.chart.height=e.size.height)),o},e=function(n,t){var i=n.getExtremes();(t.currentMin!==i.dataMin||t.currentMax!==i.dataMax)&&(n.setExtremes?n.setExtremes(t.currentMin,t.currentMax,!1):n.detachedsetExtremes(t.currentMin,t.currentMax,!1))},v=function(n,t,i){(t.currentMin||t.currentMax)&&n[i][0].setExtremes(t.currentMin,t.currentMax,!0)},o=function(t){return angular.extend(n({},t),{data:null,visible:null})},s=function(n){return n.config===undefined?"Chart":l[(""+n.config.chartType).toLowerCase()]||(n.config.useHighStocks?"StockChart":"Chart")};return{restrict:"EAC",replace:!0,template:"<div><\/div>",scope:{config:"=",disableDataWatch:"="},link:p}}angular.module("highcharts-ng",[]).factory("highchartsNG",["$q","$window",r]).directive("highchart",["highchartsNG","$timeout",u])}(),function(n){"use strict";n.module("tubular-hchart.directives",["tubular.services","highcharts-ng"]).component("tbHighcharts",{template:'<div class="tubular-chart"><highchart config="$ctrl.options" ng-hide="$ctrl.isEmpty || $ctrl.hasError"><\/highchart><div class="alert alert-info" ng-show="$ctrl.isEmpty">{{$ctrl.emptyMessage}}<\/div><div class="alert alert-warning" ng-show="$ctrl.hasError">{{$ctrl.errorMessage}}<\/div><\/div>',bindings:{serverUrl:"@",title:"@?",requireAuthentication:"=?",name:"@?chartName",chartType:"@?",emptyMessage:"@?",errorMessage:"@?",onLoad:"=?",options:"=?",onClick:"=?"},controller:["$scope","tubularHttp","$timeout",function(t,i,r){var u=this;u.dataService=i.getDataService(u.dataServiceName);u.showLegend=n.isUndefined(u.showLegend)?!0:u.showLegend;u.chartType=u.chartType||"line";u.options=n.extend({},u.options,{options:{chart:{type:u.chartType},plotOptions:{pie:{point:{events:{click:u.onClick||n.noop}}},series:{point:{events:{click:u.onClick||n.noop}}}}},title:{text:u.title||""},xAxis:{categories:[]},yAxis:{},series:[]});u.requireAuthentication=n.isUndefined(u.requireAuthentication)?!0:u.requireAuthentication;u.loadData=function(){i.setRequireAuthentication(u.requireAuthentication);u.hasError=!1;i.get(u.serverUrl).promise.then(u.handleData,function(n){t.$emit("tbChart_OnConnectionError",n);u.hasError=!0})};u.handleData=function(n){if(!n||!n.Data||n.Data.length===0){if(u.isEmpty=!0,u.options.series=[{data:[]}],u.onLoad)u.onLoad(u.options,{});return}if(u.isEmpty=!1,n.Series)u.options.xAxis.categories=n.Labels,u.options.series=n.Series.map(function(t,i){return{name:t,data:n.Data[i]}});else{var t=n.Labels.map(function(t,i){return{name:t,y:n.Data[i]}});u.options.series=[{name:n.SerieName||"",data:t,showInLegend:(n.SerieName||"")!==""}]}if(u.onLoad){r(function(){u.onLoad(u.options,{},u.options.getHighcharts().series)},100);u.onLoad(u.options,{},null)}};t.$watch("$ctrl.serverUrl",function(t){n.isDefined(t)&&t!=null&&t!==""&&u.loadData()});t.$watch("$ctrl.chartType",function(t){n.isDefined(t)&&t!=null&&(u.options.options.chart.type=t)})}]})}(angular);