var Workshop=function(){function workshop_ajax(e,t,o){if(void 0===e)throw Error("Parameters are required");if((void 0===e.debug||null==e.debug)&&(e.debug=!1),void 0===e.url)throw Error("URL is required for Workshop.ajax");if(void 0===e.method||"GET"!=e.method&&"POST"!=e.method&&"DELETE"!=e.method&&"PUT"!=e.method)throw Error("method for Workshop.ajax is required and must be GET, POST, DELETE or PUT only");var r=new XMLHttpRequest;r.onreadystatechange=function(){if(4==r.readyState){if(r.status==(e.status||200))return void 0!==t&&t(null,r.responseText,r),r.responseText;e.debug&&console.log("XMl Error: readyState: ",r.readyState," status:",r.status),void 0!==t&&t({error:{message:r.statusText,state:r.readyState,status:r.status}},r.responseText,r)}},o&&(r.upload.onloadstarts=o.onloadstarts||null,r.upload.onprogress=o.onprogress||null,r.upload.onerror=r.upload.onabort=r.upload.ontimeout=o.onerror||null,r.upload.onload=o.onload||null,r.upload.onloadend=o.onloadend||null),r.onerror=function(){e.debug&&console.log("XMl Error: readyState: ",r.readyState," status:",r.status),void 0!==t&&t({error:{message:r.statusText,state:r.readyState,status:r.status}},r.responseText,r)};var n;if(n=void 0!==e.async?e.async:!0,"GET"==e.method||"DELETE"==e.method)if(void 0===e.data)r.open(e.method,e.url,n),r.setRequestHeaders(e.headers||{}),r.send();else{var i="/"==e.url.substring(e.url.length-1,e.url.length)?"?":"/?";for(var s in e.data)i+=s+"="+e.data[s]+"&";i=i.substring(0,i.length-1),e.url+=i,r.open(e.method,e.url,n),r.setRequestHeaders(e.headers||{}),r.send()}else("POST"==e.method||"PUT"==e.method)&&(r.open(e.method,e.url,n),r.setRequestHeaders(e.headers||{}),void 0!==e.data?r.send(e.headers&&e.headers["Content-Type"]&&"application/json"==e.headers["Content-Type"]?JSON.stringify(e.data):e.data):r.send())}function registerPushInit(e,t){function o(t){if(Workshop.notifications.config.debug&&console.log("Entered init"),t=t?t:function(e){console.log(e)},!("showNotification"in ServiceWorkerRegistration.prototype)){var o={message:"showNotification not supported by ServiceWorkerRegistration",code:1002};return void t(o)}if("denied"===Notification.permission){var o={message:"Permission for notifications is denied",code:1003};return void t(o)}if(!("PushManager"in window)){var o={message:"PushManager not supported",code:1003};return void t(o)}navigator.serviceWorker.ready.then(function(o){Workshop.notifications.config.debug&&console.log("Entered serviceWorker.ready on init",o),o.pushManager.getSubscription().then(function(o){if(!o){var r={message:"No Current Subscription",code:1006};return t(r),void e(!1,{from:{name:"getSubscription",code:1}})}Workshop.notifications.config.debug&&console.log("Got Subscription on Init: ",o),sendToServer(o),e(!0,{from:{name:"getSubscription",code:1}})}).catch(function(e){t(e)})})}if(Workshop.notifications.config.debug&&console.log("Entered registerPushInit"),!e||void 0===e)throw Error("Callback must be defined");if(!1 in navigator){var r={message:"ServiceWorkers not supported in this navigator",code:1001};return void t(r)}if(!Workshop.notifications.config._service_worker||void 0===Workshop.notifications.config._service_worker)throw Error("Workshop service worker is not defined, please use Workshop.notifications.config.setServiceWorker('./path/to/sw.js')");Workshop.notifications.config.debug&&console.log("Service worker path: ",Workshop.notifications.config._service_worker),navigator.serviceWorker.register(Workshop.notifications.config._service_worker).then(function(){o(t)})}function subscribeToGCM(e,t){if(Workshop.notifications.config.debug&&console.log("Entered subscribe"),!e||void 0===e)throw Error("Callback must be defined");t=t?t:function(e){console.log(e)},navigator.serviceWorker.ready.then(function(o){o.pushManager.subscribe({userVisibleOnly:!0}).then(function(t){return Workshop.notifications.config.debug&&console.log("Entered subscribre on pushManager:",t),e(!0,{from:{name:"subscribe",code:2}}),sendToServer(t)}).catch(function(o){if("denied"===Notification.permission){var r={message:"Permission to notify denied",code:1003};return t(r),void e(!1,{from:{name:"subscribe",code:3}})}var r={message:"Error with subscription (check manifest.json, and if it's loaded in your browser, or well written)",original:o,code:1004};return e(!1,{from:{name:"subscribe",code:4}}),void t(r)})})}function unsubscribeFromGCM(e,t){if(Workshop.notifications.config.debug&&console.log("Entered unsubscribe"),!e||void 0===e)throw Error("Callback must be defined");t=t?t:function(e){console.log(e)},navigator.serviceWorker.ready.then(function(o){o.pushManager.getSubscription().then(function(o){if(!o)return void e(!1,{from:{name:"getSubscription",code:5}});o.subscriptionId;o.unsubscribe().then(function(){e(!0,{from:{name:"unsubscribe",code:6}})}).catch(function(o){var r={message:"Error while unsibscribing: "+o,code:1005};e(!1,{from:{name:"unsubscribe",code:6}}),t(r)})}).catch(function(o){var r={message:"Error while unsibscribing: "+o,code:1004};e(!1,{from:{name:"getSubscription",code:7}}),t(r)})})}function sendToServer(e){Workshop.notifications.config.debug&&console.log("Sending to server (",Workshop.notifications.config._server_endpoint,") :",e);var t={url:Workshop.notifications.config._server_endpoint,method:"POST",data:{subscription:""+e.endpoint}},o=function(e){console.log("Resp from server:",e)};Workshop.ajax(t,o)}var Workshop={};Object.defineProperty(document,"getElementsByAttributeName",{enumerable:!1,value:function(e,t){return e.includes("*")||e instanceof RegExp?Array.from(document.querySelectorAll(t||"*")).filter(function(t){var o=!1;return Array.from(t.attributes).forEach(function(t){o=e instanceof RegExp?t.name.match(e):t.name.startsWith(e.slice(0,e.indexOf("*")))}),o}):document.querySelectorAll("["+e+"]")}}),Object.defineProperty(document,"getElementsByAttribute",{enumerable:!1,value:function(e,t){return document.querySelectorAll("["+e+"="+t+"]")}}),Object.defineProperty(Object,"equals",{enumerable:!1,value:function(e,t){for(var o in e){if(void 0===t[o])return!1;if(t[o]!=e[o])return!1}for(var o in t){if(void 0===e[o])return!1;if(t[o]!=e[o])return!1}return!0}}),Object.defineProperty(Object,"isStrictlyEqual",{enumerable:!1,value:function(e,t){for(var o in e){if(void 0===t[o])return!1;if(t[o]!==e[o])return!1}for(var o in t){if(void 0===e[o])return!1;if(t[o]!==e[o])return!1}return!0}}),Object.defineProperty(Object,"duplicate",{enumerable:!1,writable:!1,value:function(e){if(e instanceof Array)return e.duplicate();var t={};for(var o in e)t[o]=e[o]instanceof Object?Object.duplicate(e[o]):e[o];return t}}),Object.defineProperty(Object,"compare",{enumerable:!1,value:function(e,t,o){for(var r=0;r<o.length;r++){var n=o[r];if(void 0===e[n]||void 0===t[n])return!1;if(e[n]!=t[n])return!1}return!0}}),Object.defineProperty(Object,"sort",{enumerable:!1,value:function(e){var t=Object.keys(e).sort(),o={};return t.forEach(function(t){o[t]=e[t]}),o}}),Object.defineProperty(Array.prototype,"findObjectByProperty",{value:function(e,t){for(var o=0;o<this.length;o++)if(this[o][e]==t)return this[o].found_index=o,this[o];return null},enumerable:!1,writable:!1}),Object.defineProperty(Array.prototype,"findObjectsByProperty",{value:function(e,t){for(var o=[],r=0;r<this.length;r++)this[r][e]==t&&(this[r].found_index=r,o.push(this[r]));return 0==o.length?null:o},enumerable:!1,writable:!1}),Object.defineProperty(Array.prototype,"first",{get:function(){return this[0]},set:function(e){this[0]=e},enumerable:!1}),Object.defineProperty(Array.prototype,"lastIndexByProperty",{enumerable:!1,writable:!1,value:function(e,t){var o=this.findObjectsByProp(e,t);if(o!=[])return o=o.sort(function(e,t){return e.found_index-t.found_index}),o.last.found_index}}),Object.defineProperty(Array.prototype,"firstIndexByProperty",{enumerable:!1,writable:!1,value:function(e,t){var o=this.findObjectsByProp(e,t);if(o!=[])return o=o.sort(function(e,t){return e.found_index-t.found_index}),o[0].found_index}}),Object.defineProperty(Array.prototype,"indexOfObject",{enumerable:!1,writable:!1,value:function(e,t,o){var r=Object.isStrictlyEqual;void 0!==o&&(r=Object.compare),void 0===t&&(t=0);for(var n=t;n<this.length;n++)if(r(this[n],e,o))return n;return-1}}),Object.defineProperty(Array.prototype,"last",{get:function(){return this[this.length-1]},set:function(e){this[this.length-1]=e},enumerable:!1}),Object.defineProperty(Array.prototype,"isUnique",{enumerable:!1,get:function(){for(var e=[],t=0;t<this.length;t++)-1!=this.indexOf(this[t],t+1)&&e.push(this[t]);return e.length>0?{result:!1,not_unique:e}:{result:!0}}}),Object.defineProperty(Array.prototype,"duplicate",{enumerable:!1,value:function(){return this.slice(0)}}),Object.defineProperty(Number.prototype,"isBetween",{value:function(e,t,o){switch(o||(o=0),o){case-1:if(this>=e&&t>this)return!0;break;case 2:if(this>=e&&t>=this)return!0;break;case 1:if(this>e&&t>=this)return!0;break;case 0:if(this>e&&t>this)return!0}return!1},enumerable:!1,writable:!1}),Math.ZERO=0,Math.GOLDEN_RATIO=(Math.sqrt(5)+1)/2,Math.INVERSE_GOLDEN_RATIO=1/Math.GOLDEN_RATIO,Math.GOOGOL=1e100,Math.G=9.80665,Math.AU=149597870660,Math.map={linear:function(e,t,o){if(t.x==o.x)throw Error("In a linear expression xa and xb cannot be the same value");if(t.y==o.y)throw Error("In a linear expression ya and yb cannot be the same value");var r=(o.y-t.y)/(o.x-t.x),n=t.y-r*t.x;return r*e+n},bounds:function(e,t,o){return Math.map.linear(e,{x:t.min,y:o.min},{x:t.max,y:o.max})}},Math.die=function(e){this.sides=e,this.roll=function(){return Math.ceil(Math.random()*this.sides)}},Math.roll_die=function(e,t){void 0===e&&(e=1),void 0===t&&(t=6);for(var o=0,r=0;e>r;r++)o+=Math.ceil(Math.random()*t);return o},Math.randomInt=function(e,t){return Math.floor(Math.random()*(t-e)+e)},Math.sum=function _mathSum(from,to,formula,step){step=step?step:1,to+=step;for(var res=0,i=from;to>i;i+=step){var tempFor=formula.replace("x",i);res+=eval(tempFor)}return res},Math.mult=function _mathMult(from,to,formula,step){step=step?step:1,to+=step;for(var res=1,i=from;to>i;i+=step){var tempFor=formula.replace("x",i);res*=eval(tempFor)}return res},Math.hypothenuse=function(e,t){return Math.sqrt(Math.pow(e,2)+Math.pow(t,2))},Object.defineProperty(String.prototype,"reverse",{enumerable:!1,value:function(){return this.split("").reverse().join("")}}),Object.defineProperty(HTMLFormElement.prototype,"validate",{enumerable:!1,value:function(e,t){void 0===e&&(e="none"),void 0===t&&(t="#c62828 solid 1px");for(var o=0;o<this.elements.length;o++)if(this.elements[o].style.outline="none",this.elements[o].getAttribute("optional")!==!0&&""!=this.elements[o].getAttribute("optional")){if(""==this.elements[o].value)return this.elements[o].style.outline="#c62828 solid 1px",!1;this.elements[o].style.outile=e}return!0}}),XMLHttpRequest.prototype.setRequestHeaders=function(e,t){t||(t="application/json");for(var o in e)this.setRequestHeader(o,e[o])},Workshop.ajax=workshop_ajax,Workshop.getDeviceOrientation=function(e){window.addEventListener("deviceorientation",e)},Workshop.getDeviceMotion=function(e){window.addEventListener("devicemotion",e)},Workshop.getDeviceMovement=function(e){var t={};window.addEventListener("deviceorientation",function(o){t.alpha=o.alpha,t.beta=o.beta,t.gamma=o.gamma,e(t)}),window.addEventListener("devicemotion",function(o){t.acceleration=o.acceleration,t.gravity=o.accelerationIncludingGravity,e(t)})},Workshop.getGeoLocation=function(e,t){function o(t){var o={coords:{latitude:t.coords.latitude,longitude:t.coords.longitude},accuracy:t.coords.accuracy,altitude:{value:t.coords.altitude,accuracy:t.coords.altitudeAccuracy},speed:t.coords.speed,timestamp:t.timestamp};return e(o),t}function t(e){t(e)}if(!navigator){var r={message:"Navigator does not exist",code:101};return void t(r)}if(!navigator.geolocation){var r={message:"Geolocation not available in this browser",code:102};return void t(r)}navigator.geolocation.getCurrentPosition(o,t)},Workshop.notifications={subscribe:subscribeToGCM,unsubscribe:unsubscribeFromGCM,init:registerPushInit,config:{debug:!0,setDebug:function(e){e?(Workshop.notifications.config.debug=!0,console.log("Set debug to true")):(Workshop.notifications.config.debug=!1,console.log("Set debug to false"))},isEnabled:!1,_server_endpoint:null,_service_worker:null,setServiceWorker:function(e){if(!e||void 0===e)throw Error("Service Worker Path must be defined");Workshop.notifications.config._service_worker=e},setServerEndpoint:function(e){if(!e||void 0===e)throw Error("Endpoint must be defined");Workshop.notifications.config._server_endpoint=e}}},Object.defineProperty(Date.prototype,"toSeconds",{enumerable:!1,value:function(){return 3600*this.getHours()+3600*this.getMinutes()+this.getSeconds()}}),Object.defineProperty(Date.prototype,"toFormatted",{enumerable:!1,value:function(e,t){function o(e){if(t)return e;var o="";for(var r in e)o+=e[r]+":";return o.substring(0,o.length-1)}var r={h:this.getHours(),m:this.getMinutes(),s:this.getSeconds()};switch(e){case"hh":return o({hours:r.h});case"hh:mm":return o({hours:r.h,minutes:r.m});case"hh:mm:ss":return o({hours:r.h,minutes:r.m,seconds:r.s});default:return o({hours:r.h,minutes:r.m,seconds:r.s})}}}),Object.defineProperty(Date.prototype,"minutes",{get:function(){return this.getMinutes()},set:function(e){this.setMinutes(e)}}),Object.defineProperty(Date.prototype,"hours",{get:function(){return this.getHours()},set:function(e){this.setHours(e)}}),Object.defineProperty(Date.prototype,"seconds",{get:function(){return this.getSeconds()},set:function(e){this.setSeconds(e)}}),Date.prototype.toDecimal=function(){var e=1e5/86400,t=this.getSeconds(),o=this.getMinutes(),r=this.getHours(),n=3600*r+60*o+t,i=n*e,s=i/Math.pow(100,2),a=100*(s-Math.floor(s));s=Math.floor(s);var u=Math.floor(100*(a-Math.floor(a)));return a=Math.floor(a),{string:s+":"+a+":"+u,date:{hours:s,minutes:a,seconds:u}}};var event_config={};Object.defineProperty(Object.prototype,"onWSEvent",{enumerable:!1,value:function(e,t){if(!(e instanceof Array)){if(e instanceof Object)throw Error("onWS only accepts an event as string or an array of events as strings");e=[e]}for(var o=0;o<e.length;o++){var r=e[o];if("*"!=r)r in event_config||Workshop.events.add(r),event_config[r].push({fun:t,"this":this});else for(var n in event_config){var i=event_config[n];i.push({fun:t,"this":this})}}}}),Workshop.events={},Workshop.events.add=function(e,t){if(void 0===t&&(t=!1),e in event_config&&!t)throw Error("Event already exists, if you want to clear it please use Workshop.events.add('event',true)");event_config[e]=[]},Workshop.events.emit=function(e,t){if(!(e in event_config)){if("*"===e){for(var o in event_config){var e=event_config[o];for(var r in event_config[e]){var n=event_config[e][r];try{n.fun.call(n.this,t)}catch(o){}}}return}throw Error(e+" does not exist, please use an existing event")}for(var r in event_config[e]){var n=event_config[e][r];try{n.fun.call(n.this,t)}catch(o){}}},Workshop.events.clear=function(){event_config={}};var bindings_config={show:function(){this.style.display=""},hide:function(){this.style.display="none"},disable:function(){this.setAttribute("disabled","disabled")},enable:function(){this.removeAttribute("disabled")},model:function(){}};return Workshop.bindings={},Workshop.bindings.scan=function(){},Workshop.Maybe=function(e){this.__value=e},Workshop.Maybe.of=function(e){return new Workshop.Maybe(e)},Workshop.Maybe.prototype.isNothing=function(){return null===this.__value||void 0===this.__value},Workshop.Maybe.prototype.map=function(e){return Workshop.Maybe.of(this.isNothing()?null:e(this.__value))},Workshop.Maybe.prototype.join=function(){return this.__value},Workshop.Maybe.prototype.return=Workshop.Maybe.prototype.join,Workshop.getQueryParams=function(){var e={},t=window.location.search.split("&");return t.forEach(function(t){0==t.indexOf("?")&&(t=t.slice(1,t.length)),t=t.split("="),e[t[0]]=t[1]}),e},Workshop}();